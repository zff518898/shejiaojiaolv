<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>社交焦虑量表（IAS）</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background-color: #f5f7fa; color: #333; line-height: 1.6; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background-color: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); overflow: hidden; }
        
        header {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e063 100%);
            color: white; padding: 30px; text-align: center;
        }
        header h1 { font-size: 2.2rem; margin-bottom: 10px; display: flex; align-items: center; justify-content: center; gap: 15px; }
        .subtitle { font-size: 1.2rem; opacity: 0.9; margin-bottom: 20px; }
        .disclaimer {
            background-color: rgba(255, 255, 255, 0.15);
            border-left: 4px solid #ffcc00; padding: 15px; border-radius: 5px;
            text-align: left; margin-top: 20px; font-size: 0.95rem;
        }
        
        .card { background-color: white; border-radius: 10px; padding: 30px; margin: 20px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05); }
        .hidden { display: none !important; }
        
        .options-info {
            display: flex; flex-wrap: wrap; justify-content: space-between; margin: 25px 0; gap: 10px;
        }
        .option-item {
            flex: 1; min-width: 120px; background-color: #f0f5ff; padding: 12px; border-radius: 8px; text-align: center;
        }
        .option-label {
            display: inline-block; width: 30px; height: 30px; background-color: #56ab2f;
            color: white; border-radius: 50%; line-height: 30px; margin-right: 10px; font-weight: bold;
        }
        
        .btn-primary, .btn-secondary {
            padding: 14px 28px; border: none; border-radius: 8px; font-size: 1.1rem; font-weight: 600;
            cursor: pointer; transition: all 0.3s ease; display: inline-flex; align-items: center; justify-content: center; gap: 10px;
        }
        .btn-primary { background-color: #56ab2f; color: white; }
        .btn-primary:hover { background-color: #3e8e23; transform: translateY(-2px); box-shadow: 0 5px 15px rgba(86, 171, 47, 0.3); }
        .btn-secondary { background-color: #f0f5ff; color: #56ab2f; border: 2px solid #56ab2f; }
        .btn-secondary:hover { background-color: #e1e9ff; }
        .actions { display: flex; justify-content: center; gap: 20px; margin-top: 30px; }
        
        #questions-container { margin: 25px 0; }
        .question { margin-bottom: 25px; padding-bottom: 25px; border-bottom: 1px solid #eee; }
        .question:last-child { border-bottom: none; }
        .question-text { font-size: 1.1rem; margin-bottom: 15px; color: #333; font-weight: 600; }
        .options { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; }
        .option {
            background-color: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px; padding: 12px 15px;
            cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center;
        }
        .option:hover { background-color: #e9ecef; }
        .option.selected { background-color: #e2f0d9; border-color: #56ab2f; color: #56ab2f; }
        .option input { margin-right: 10px; }
        .navigation {
            display: flex; justify-content: space-between; align-items: center; margin-top: 30px;
            padding-top: 20px; border-top: 1px solid #eee;
        }
        #page-info { font-weight: 600; color: #56ab2f; }
        
        .progress-container { margin: 20px 0; }
        .progress-bar { height: 10px; background-color: #e9ecef; border-radius: 5px; overflow: hidden; }
        .progress-fill { height: 100%; width: 0%; background: linear-gradient(90deg, #56ab2f, #a8e063); border-radius: 5px; transition: width 0.5s ease; }
        .progress-text { text-align: center; margin-top: 10px; font-weight: 600; color: #56ab2f; }
        
        .score-category { margin-bottom: 30px; padding: 20px; background-color: #f8f9fa; border-radius: 10px; }
        .score-category h3 { margin-bottom: 15px; color: #56ab2f; font-size: 1.4rem; }
        .score-bar { height: 25px; background-color: #e9ecef; border-radius: 12px; overflow: hidden; margin-bottom: 15px; }
        .score-fill { height: 100%; width: 0%; background: linear-gradient(90deg, #56ab2f, #a8e063); border-radius: 12px; transition: width 1.5s ease; }
        .score-details { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
        .score-details p { margin: 0; font-weight: 600; }
        
        .anxiety-card {
            border-radius: 10px; padding: 25px; margin-bottom: 25px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease;
        }
        .anxiety-card:hover { transform: translateY(-5px); }
        .anxiety-card h3 { display: flex; align-items: center; gap: 10px; margin-bottom: 15px; font-size: 1.4rem; }
        
        .level-low { background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%); border-left: 6px solid #28a745; }
        .level-moderate { background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%); border-left: 6px solid #ffc107; }
        .level-high { background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%); border-left: 6px solid #dc3545; }
        
        #interpretation { margin-top: 30px; padding: 25px; background-color: #f8f9fa; border-radius: 10px; }
        #interpretation h3 { margin-bottom: 15px; color: #56ab2f; display: flex; align-items: center; gap: 10px; }
        .recommendation-item { background-color: white; padding: 15px; margin-bottom: 15px; border-radius: 8px; border-left: 4px solid #56ab2f; }
        
        footer { background-color: #f8f9fa; padding: 20px; text-align: center; color: #666; font-size: 0.9rem; line-height: 1.5; border-top: 1px solid #eee; }
        
        @media (max-width: 768px) {
            .container { border-radius: 0; }
            header h1 { font-size: 1.8rem; flex-direction: column; gap: 10px; }
            .card { padding: 20px; margin: 10px; }
            .options { grid-template-columns: 1fr; }
            .score-details { grid-template-columns: 1fr; gap: 10px; }
            .actions { flex-direction: column; }
            .btn-primary, .btn-secondary { width: 100%; margin-bottom: 10px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-users"></i> 社交焦虑量表（IAS）</h1>
            <p class="subtitle">评估人际交往中的主观焦虑感受</p>
            <div class="disclaimer">
                <p><strong>重要提示：</strong>本量表用于测量日常社交情境中的焦虑倾向，结果仅供参考，不能替代专业心理评估。如感困扰，请寻求专业帮助。</p>
            </div>
        </header>

        <main>
            <!-- 说明部分 -->
            <section id="instructions" class="card">
                <h2><i class="fas fa-info-circle"></i> 测试说明</h2>
                <p>请根据您在<strong>日常社交情境中</strong>的真实感受，评估每个描述与您的符合程度。答案无对错，请按第一反应作答。</p>
                <p>每个问题有5个选项：</p>
                <div class="options-info">
                    <div class="option-item"><span class="option-label">1</span> 完全不符合</div>
                    <div class="option-item"><span class="option-label">2</span> 比较不符合</div>
                    <div class="option-item"><span class="option-label">3</span> 不确定</div>
                    <div class="option-item"><span class="option-label">4</span> 比较符合</div>
                    <div class="option-item"><span class="option-label">5</span> 完全符合</div>
                </div>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
                    </div>
                    <div class="progress-text" id="progress-text">请回答所有问题以获得准确结果</div>
                </div>
                <button id="start-btn" class="btn-primary">开始测试</button>
            </section>

            <!-- 问卷部分 -->
            <section id="questionnaire" class="card hidden">
                <h2><i class="fas fa-clipboard-list"></i> 交往焦虑量表（IAS）</h2>
                <div id="questions-container"></div>
                <div class="navigation">
                    <button id="prev-btn" class="btn-secondary"><i class="fas fa-arrow-left"></i> 上一题</button>
                    <span id="page-info">第 <span id="current-page">1</span> 题 / 共 15 题</span>
                    <button id="next-btn" class="btn-secondary">下一题 <i class="fas fa-arrow-right"></i></button>
                </div>
                <button id="submit-btn" class="btn-primary hidden">查看结果</button>
            </section>

            <!-- 结果部分 -->
            <section id="results" class="card hidden">
                <h2><i class="fas fa-chart-bar"></i> 测试结果</h2>
                
                <div class="score-category">
                    <h3>您的社交焦虑总分</h3>
                    <div class="score-bar">
                        <div id="total-bar" class="score-fill"></div>
                    </div>
                    <div class="score-details">
                        <p>总分: <span id="total-score">0</span> / 75</p>
                        <p>焦虑水平: <span id="anxiety-level">中等</span></p>
                        <p>百分位: <span id="percentile">-</span></p>
                    </div>
                </div>
                
                <div id="anxiety-summary">
                    <h3><i class="fas fa-heartbeat"></i> 社交焦虑概述</h3>
                    <div id="anxiety-summary-content"></div>
                </div>
                
                <div id="interpretation">
                    <h3><i class="fas fa-comment-medical"></i> 结果解读</h3>
                    <div id="interpretation-content"></div>
                </div>
                
                <div class="actions">
                    <button id="restart-btn" class="btn-secondary"><i class="fas fa-redo"></i> 重新测试</button>
                    <button id="print-btn" class="btn-secondary"><i class="fas fa-print"></i> 打印结果</button>
                </div>
            </section>
        </main>

        <footer>
            <p>社交焦虑量表（IAS） - Interaction Anxiousness Scale (Leary, 1983)</p>
            <p>参考: Leary, M. R. (1983). Social anxiousness: The construct and its measurement.</p>
            <p>© 2023 心理健康工具 | 仅供教育参考使用</p>
        </footer>
    </div>

    <script>
        // IAS 15个条目（包含反向计分）
        const iasQuestions = [
            { id: 1, text: "即使在非正式的聚会上，我也常常感到紧张。", reversed: false },
            { id: 2, text: "与一群不太熟悉的人在一起，我通常感到放松。", reversed: true },
            { id: 3, text: "与异性交谈时，我常常会感到更加紧张。", reversed: false },
            { id: 4, text: "在必须与老师或上司谈话时，我感到紧张。", reversed: false },
            { id: 5, text: "聚会常使我感到焦虑和不自在。", reversed: false },
            { id: 6, text: "与大多数人相比，我在社交场合可能不那么害羞。", reversed: true },
            { id: 7, text: "与不太熟悉的人交谈时，我常常感到紧张。", reversed: false },
            { id: 8, text: "在求职面试时，我通常会感到紧张。", reversed: false },
            { id: 9, text: "我希望自己在社交场合有更多的自信。", reversed: false },
            { id: 10, text: "我在社交场合很少感到焦虑。", reversed: true },
            { id: 11, text: "通常，我在社交场合感到舒适自在。", reversed: true },
            { id: 12, text: "与异性交谈时，我通常感到放松。", reversed: true },
            { id: 13, text: "与重要人物交谈时，我会感到紧张。", reversed: false },
            { id: 14, text: "我经常担心自己会说错话或做错事。", reversed: false },
            { id: 15, text: "我通常在聚会中感到自在。", reversed: true }
        ];

        // 社交焦虑等级（总分范围15-75）
        const anxietyLevels = [
            { min: 15, max: 30, level: "较低", class: "level-low", desc: "您在社交情境中较少感到焦虑，通常能够轻松应对人际交往。" },
            { min: 31, max: 45, level: "中等", class: "level-moderate", desc: "您在有些社交场合会感到焦虑，但整体可控，属于大多数人的正常范围。" },
            { min: 46, max: 60, level: "较高", class: "level-high", desc: "您在社交中经常感到焦虑，可能会回避一些社交情境，需要关注。" },
            { min: 61, max: 75, level: "很高", class: "level-high", desc: "您有明显的社交焦虑，可能严重影响日常生活，建议寻求专业评估。" }
        ];

        // 应用状态
        let currentQuestion = 1;
        let answers = new Array(iasQuestions.length).fill(null);

        // DOM元素
        const instructionsSection = document.getElementById('instructions');
        const questionnaireSection = document.getElementById('questionnaire');
        const resultsSection = document.getElementById('results');
        const questionsContainer = document.getElementById('questions-container');
        const startBtn = document.getElementById('start-btn');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const submitBtn = document.getElementById('submit-btn');
        const restartBtn = document.getElementById('restart-btn');
        const printBtn = document.getElementById('print-btn');
        const currentPageSpan = document.getElementById('current-page');
        const progressFill = document.getElementById('progress-fill');
        const progressText = document.getElementById('progress-text');

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            console.log('社交焦虑量表(IAS)初始化...');
            
            startBtn.addEventListener('click', startQuestionnaire);
            prevBtn.addEventListener('click', goToPrevQuestion);
            nextBtn.addEventListener('click', goToNextQuestion);
            submitBtn.addEventListener('click', showResults);
            restartBtn.addEventListener('click', restartQuestionnaire);
            printBtn.addEventListener('click', printResults);
            
            renderQuestion();
            updateProgress();
        });

        function startQuestionnaire() {
            instructionsSection.classList.add('hidden');
            questionnaireSection.classList.remove('hidden');
            resultsSection.classList.add('hidden');
            currentQuestion = 1;
            renderQuestion();
        }

        function renderQuestion() {
            questionsContainer.innerHTML = '';
            const question = iasQuestions[currentQuestion - 1];
            
            const questionElement = document.createElement('div');
            questionElement.className = 'question';
            questionElement.innerHTML = `
                <div class="question-text">${question.id}. ${question.text}</div>
                <div class="options">
                    ${[1, 2, 3, 4, 5].map(value => `
                        <label class="option ${answers[currentQuestion - 1] === value ? 'selected' : ''}">
                            <input type="radio" name="question-${question.id}" value="${value}" 
                                   ${answers[currentQuestion - 1] === value ? 'checked' : ''}>
                            <span class="option-label">${value}</span> ${getOptionText(value)}
                        </label>
                    `).join('')}
                </div>
            `;
            
            const radioInputs = questionElement.querySelectorAll('input[type="radio"]');
            radioInputs.forEach(input => {
                input.addEventListener('change', function() {
                    answers[currentQuestion - 1] = parseInt(this.value);
                    updateProgress();
                    
                    if (currentQuestion < iasQuestions.length) {
                        currentQuestion++;
                        setTimeout(() => {
                            renderQuestion();
                        }, 300);
                    } else {
                        setTimeout(() => {
                            renderQuestion();
                        }, 300);
                    }
                });
            });
            
            questionsContainer.appendChild(questionElement);
            
            if (currentPageSpan) currentPageSpan.textContent = currentQuestion;
            
            if (prevBtn) prevBtn.disabled = currentQuestion === 1;
            if (nextBtn) nextBtn.disabled = currentQuestion === iasQuestions.length;
            if (submitBtn) {
                submitBtn.classList.toggle('hidden', currentQuestion !== iasQuestions.length);
                
                if (currentQuestion === iasQuestions.length && answers[currentQuestion - 1] !== null) {
                    submitBtn.disabled = false;
                } else if (currentQuestion === iasQuestions.length) {
                    submitBtn.disabled = true;
                }
            }
        }

        function getOptionText(value) {
            const texts = {
                1: "完全不符合",
                2: "比较不符合",
                3: "不确定",
                4: "比较符合",
                5: "完全符合"
            };
            return texts[value];
        }

        function updateProgress() {
            const answeredCount = answers.filter(answer => answer !== null).length;
            const totalQuestions = iasQuestions.length;
            const progressPercentage = (answeredCount / totalQuestions) * 100;
            
            if (progressFill) progressFill.style.width = `${progressPercentage}%`;
            if (progressText) {
                progressText.textContent = `已回答 ${answeredCount} / ${totalQuestions} 题`;
                if (answeredCount === totalQuestions) {
                    progressText.innerHTML = `<strong>所有问题已回答完毕！可以点击"查看结果"</strong>`;
                }
            }
        }

        function goToPrevQuestion() {
            if (currentQuestion > 1) {
                currentQuestion--;
                renderQuestion();
            }
        }

        function goToNextQuestion() {
            if (currentQuestion < iasQuestions.length) {
                currentQuestion++;
                renderQuestion();
            }
        }

        // 计算总分（考虑反向计分）
        function calculateScore() {
            let total = 0;
            iasQuestions.forEach((q, idx) => {
                const answer = answers[idx];
                if (answer !== null) {
                    if (q.reversed) {
                        // 反向计分：6 - 原始分
                        total += (6 - answer);
                    } else {
                        total += answer;
                    }
                }
            });
            return total;
        }

        function getAnxietyLevel(total) {
            for (let level of anxietyLevels) {
                if (total >= level.min && total <= level.max) return level;
            }
            return anxietyLevels[1]; // 默认中等
        }

        function showResults() {
            const allAnswered = answers.every(answer => answer !== null);
            if (!allAnswered) {
                alert('请回答所有问题后再查看结果！');
                return;
            }
            
            const total = calculateScore();
            const level = getAnxietyLevel(total);
            
            document.getElementById('total-score').textContent = total;
            document.getElementById('anxiety-level').textContent = level.level;
            
            // 简单百分位估算
            let percentile = '';
            if (total <= 30) percentile = '低于25%人群';
            else if (total <= 45) percentile = '约25%-75%人群';
            else percentile = '高于75%人群';
            document.getElementById('percentile').textContent = percentile;
            
            setTimeout(() => {
                const totalBar = document.getElementById('total-bar');
                if (totalBar) {
                    totalBar.style.width = `${(total / 75) * 100}%`;
                }
            }, 100);
            
            generateAnxietySummary(total, level);
            generateInterpretation(total, level);
            
            questionnaireSection.classList.add('hidden');
            resultsSection.classList.remove('hidden');
            resultsSection.scrollIntoView({ behavior: 'smooth' });
        }

        function generateAnxietySummary(total, level) {
            const summaryContent = document.getElementById('anxiety-summary-content');
            summaryContent.innerHTML = `
                <div class="anxiety-card ${level.class}">
                    <h3><i class="fas fa-chart-line"></i> 社交焦虑水平: ${level.level}</h3>
                    <p>${level.desc}</p>
                </div>
            `;
        }

        function generateInterpretation(total, level) {
            const interpretationContent = document.getElementById('interpretation-content');
            
            let html = `
                <p>社交焦虑量表(IAS)总分范围15-75，分数越高表示社交焦虑越明显。您的总分<strong>${total}</strong>分，属于<strong>${level.level}</strong>水平。</p>
                <div class="recommendation-item">
                    <h4>总分解读</h4>
                    <p>${level.desc}</p>
                </div>
            `;
            
            interpretationContent.innerHTML = html;
        }

        function restartQuestionnaire() {
            answers = new Array(iasQuestions.length).fill(null);
            currentQuestion = 1;
            updateProgress();
            resultsSection.classList.add('hidden');
            instructionsSection.classList.remove('hidden');
            instructionsSection.scrollIntoView({ behavior: 'smooth' });
        }

        function printResults() {
            const printWindow = window.open('', '_blank');
            const total = calculateScore();
            const level = getAnxietyLevel(total);
            
            printWindow.document.write(`
                <html>
                <head>
                    <title>社交焦虑量表(IAS)评估报告</title>
                    <style>
                        body { font-family: Arial, sans-serif; line-height: 1.6; padding: 20px; }
                        h1, h2, h3 { color: #333; }
                        .score-table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                        .score-table th, .score-table td { border: 1px solid #ddd; padding: 12px; text-align: left; }
                        .score-table th { background-color: #f2f2f2; }
                        .anxiety-box { padding: 15px; margin: 15px 0; border-radius: 8px; }
                        .level-low { background-color: #d4edda; border-left: 6px solid #28a745; }
                        .level-moderate { background-color: #fff3cd; border-left: 6px solid #ffc107; }
                        .level-high { background-color: #f8d7da; border-left: 6px solid #dc3545; }
                        .recommendation { background-color: #f8f9fa; padding: 15px; margin: 15px 0; }
                        .footer { margin-top: 30px; font-size: 12px; color: #666; text-align: center; }
                    </style>
                </head>
                <body>
                    <h1>社交焦虑量表(IAS)评估报告</h1>
                    <p><strong>测试日期：</strong> ${new Date().toLocaleDateString('zh-CN')}</p>
                    
                    <h2>总分</h2>
                    <p><strong>总分：</strong> ${total} / 75</p>
                    <p><strong>焦虑水平：</strong> ${level.level}</p>
                    
                    <h2>结果解读</h2>
                    <div class="anxiety-box ${level.class}">
                        <p>${level.desc}</p>
                    </div>
                    
                    <h2>重要提示</h2>
                    <div class="recommendation">
                        <p>本量表仅用于自我评估，不能替代专业心理诊断。如果社交焦虑影响您的日常生活，请寻求心理健康专业人士的帮助。</p>
                    </div>
                    
                    <div class="footer">
                        <p>社交焦虑量表（IAS） - Interaction Anxiousness Scale (Leary, 1983)</p>
                        <p>© ${new Date().getFullYear()} 心理健康工具 | 仅供教育参考使用</p>
                    </div>
                </body>
                </html>
            `);
            
            printWindow.document.close();
            printWindow.focus();
            setTimeout(() => printWindow.print(), 250);
        }
    </script>
</body>
</html>